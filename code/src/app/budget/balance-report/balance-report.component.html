<div clas="spanel panel-primary">
  <div class="panel-heading">
      {{pageTitle}}
  </div>
  <div class='panel-body'>
      <pm-property-filter
          [filterProperty]='"account"'
          (selectedProperties)=selectedAccountsChanged($event)>
      </pm-property-filter>
      <pm-property-filter
          [filterProperty]='"category"'
          (selectedProperties)=selectedCategoriesChanged($event)>
      </pm-property-filter>
      <div>
        <label class="prop-radio" *ngFor="let property of groupByProperties">
          <input type="radio" [(ngModel)]="groupByProperty" name="groupBy"
                 value="{{property}}" (change)="generateReport()"/> 
          {{property}}
        </label>
      </div>
      <label>
        <input type="checkbox" name="show-averages"
               value="Show Averages"
               [(ngModel)]="showAverages">
        Show Averages
      </label>
      <br/>
      <div class='table-responsive'>
          <table class='table' *ngIf='report && report.length'>
              <thead>
                <tr>
                  <th class="sortable" (click)='reorderReport("key")'>Group By</th>
                  <th class="sortable" (click)='reorderReport("income")'>Income</th>
                  <th class="sortable" (click)='reorderReport("expense")'>Expense</th>
                  <th class="sortable" (click)='reorderReport("balance")'>Balance</th>
                  <th *ngIf='displayAverages()'>Income Average</th>
                  <th *ngIf='displayAverages()'>Income Months</th>
                  <th *ngIf='displayAverages()'>Expense Average</th>
                  <th *ngIf='displayAverages()'>Expense Average</th>
                </tr>
              </thead>
              <tbody>
                  <tr *ngFor="let entry of report">
                      <td>{{ entry.key }}</td>
                      <td>{{ entry.income.total }}</td>
                      <td>{{ entry.expense.total }}</td>
                      <td>{{ entry.balance }}</td>
                      <td *ngIf='displayAverages()'>{{ entry.income.average | number: '1.0-2' }}</td>
                      <td *ngIf='displayAverages()'>{{ entry.income.occurences }}</td>
                      <td *ngIf='displayAverages()'>{{ entry.expense.average | number: '1.0-2' }}</td>
                      <td *ngIf='displayAverages()'>{{ entry.expense.occurences }}</td>
                  </tr>
              </tbody>
          </table>
      </div>
  </div>
</div>
